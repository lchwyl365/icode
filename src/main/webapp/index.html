<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>AutoJCode-Java代码在线自动生成工具</title>
<meta content="AutoJCode-Java是一款简洁、快速、高效的Java代码生成工具，能帮助JavaWeb程序员快速完成基础编码，把精力和时间专注于业务逻辑实现上。让程序员不再编写重复的增删改查代码。" name="description" />
<meta content="Java代码生成,AutoJCode,java 在线 ide,Java自动代码生成,代码生成,软件设计,类设计" name="keywords" />
<link rel="stylesheet" type="text/css" href="css/index.css">
<link rel="stylesheet" type="text/css" href="js/google-code-prettify/prettify.css" />
<style type="text/css">
.link_btn {
  display: inline-block;
  margin-bottom: 0;
  margin-left: 10px;
  padding: 5px 10px;
  text-align: center;
  vertical-align: middle;
  border: 1px solid transparent;
  color: #fff;
  font-weight: normal;
  font-size: 16px;
  line-height: 21px;
  border-radius: 2px;
  border-color: #68c8b6;
  background-color: #5ecfba;
  text-decoration: none;
  outline: none;
}
</style>
</head>
<body>
	<div class="pager-main">
		<div class="pager-top">
			<div class="pager-top-container">
				<img src="img/logo.png" class="logo">
				<ul class="nav-ul">
					<li><a href="#">自动生成代码</a></li>
					<li><a href="#">代码实例</a></li>
					<li><a href="#">定制</a></li>
					<li><a href="#">社区</a></li>
					<li><a href="#">帮助</a></li>
				</ul>

				<ul class="login-ul">
					<li><a href="#">登录</a></li>
					<li><a href="#">注册</a></li>
				</ul>
			</div>
		</div>
		<div class="bind-crumbs">
			<div class="title-container">
				<div class="title-item icon-code">自动生成代码</div>
			</div>
		</div>
		<div class="sub-title">
			<div class="title-container">
				<ul class="menu">
					<li class="nav-current" cardid="1">
						<a href="javascript:void(0);">SQL生成代码</a></li>
					<li  cardid="2"><a href="javascript:void(0);">类生成代码</a></li>
				</ul>
			</div>
		</div>
		<div class="pager-center">
			<div class="pager-card-list">
				
				<div class="pager-card menu-card" id="card1" >
					
					<div class="card-content">
						<div class="card-left">
							<header class="card-header" style="border:0px;">
								SQL建表语句</header>
							<div class="sql-content">
								<textarea class="sql-textarea">粘贴建表语句即可生成项目代码</textarea>
								<a href="javascript:void(0);" class="textarea-clear-btn" title="清空" style="float: right; margin: 0px 0px 0px 10px; display: none;"></a>
							</div>
						</div>
						<div class="card-right">
							<header class="card-header" style="border:0px;">
								<span style="float:left;width:100px;">Java类代码</span>
								<!--<a class="link_btn" href="javascript:void(0);" data-toggle="modal" data-target="#loginModal">生成代码</a>
								<div id="sql_generate_btn" class="toolbar-btn generate_icon" 	style="line-height:29px;background-position:5px 4px;">生成代码</div>-->
								
							</header>
							<div class="class-content">
								<pre id="codePre" class="prettyprint linenums" style="border-radius:0px;min-height:223px;font-size:14px;margin-bottom:0px;margin-top:0px;"></pre>
							</div>
						</div>
					</div>
				</div>

				<div class="pager-card menu-card" id="card2" style="display:none;">
					<header class="card-header" style="margin-left:10px;margin-right:10px;">类的设计</header>
					<div class="toolbar">
						<div id="add_btn" class="toolbar-btn add_icon">添加属性</div>
						<div id="delete_btn" class="toolbar-btn delete_icon">删除属性</div>
						<div id="primary_btn" class="toolbar-btn primarykey_icon">设置主键</div>

						<div id="up_btn" class="toolbar-btn moveup_icon">上移</div>
						<div id="down_btn" class="toolbar-btn movedown_icon">下移</div>
						<input type="text" value="Test" class="classInput classNameInput">
						<input type="text" value="com.team" class="classInput packpageNameInput">

						<div id="generate_btn" class="toolbar-btn generate_icon">生成代码</div>
					</div>
					<table id="attrTable" class="editTable">
						<tr>
							<th style="width:30px;"></th>
							<th>属性名</th>
							<th style="width:160px;overflow:hidden;">类型</th>
							<th>注释</th>
							<th style="width:85px;">长度</th>
							<th style="width:90px;">允许NULL</th>
							<th style="width:50px;">主键</th>
						</tr>
						<tr id="attrRow_1" class="attrRow" index="1">
							<td>
					            <img id="triangle_1" class="triangle" 
					            	src="img/triangle.png" >
							</td>
							<td>
								<input id="attrName_1" type="text" index="1" name="attrName" class="attrInput">
							</td>
							<td>
								<select id="attrType_1" class="selectInput" name="attrType" index="1"> 
									<option selected>String</option>
									<option>Integer</option>
									<option>Long</option>
									<option>Byte</option>
									<option>Float</option>
									<option>Date</option>
								</select>
								<div id="attrTypeDiv_1" class="selectInputRight"></div>
							</td>
							<td><input id="attrComment_1" type="text" name="attrComment" index="1" class="commentInput"></td>
							<td><input id="attrLength_1" type="text" name="attrLength" value="255"
                                   onkeyup="this.value=this.value.replace(/\D/g,'')" 
                                   onafterpaste="this.value=this.value.replace(/D/g,'')" 
                                   maxlength="8" index="1" class="lengthInput"></td>
							<td class="nullTd" index="1">
								<input id="attrNull_1" type="hidden" value="true">
								<img src="img/checkbox.png"></td>
							<td class="primaryTd" index="1">
								<input id="attrPrimary_1" type="hidden" value="false">
								<img src="img/primarykey.png" style="display:none;"></td>
						</tr>
					</table>
				</div>

			</div>
		</div>
		<div class="pager-center" style="padding-bottom:60px;">
			<div class="pager-card-list">
				<div class="pager-card">
					<header class="card-header" style="margin-left:10px;margin-right:10px;">生成的代码</header>		
					<iframe id="contentFrame" 
          				frameborder="0" height="300px;" width="1140px"></iframe>
				</div>
			</div>

		</div>
	</div>

<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery.tmpl.js"></script>
<script type="text/javascript" src="js/sql2java.js"></script>
<script type="text/javascript" src="js/sly.min.js"></script>
<script type="text/javascript" src="js/google-code-prettify/prettify.js"></script>
<script type="text/javascript" src="js/layer-v1.9.3/layer/layer.js"></script>

<script id="rowTemplate" type="text/x-jquery-tmpl">
<tr id="attrRow_{{= index}}" class="attrRow" style="background-color#ff0000;" index="{{= index}}">
	<td><img id="triangle_{{= index}}" class="triangle" src="img/triangle.png" ></td>
	<td>
		<input id="attrName_{{= index}}" type="text" index="{{= index}}" name="attrName" class="attrInput">
	</td>
	<td>
		<select id="attrType_{{= index}}" name="attrType" class="selectInput" index="{{= index}}"> 
			<option selected>String</option>
			<option>Integer</option>
			<option>Long</option>
			<option>Byte</option>
			<option>Float</option>
			<option>Date</option>
		</select>
		<div id="attrTypeDiv_{{= index}}" class="selectInputRight"></div>
	</td>
	<td><input id="attrComment_{{= index}}" type="text" name="attrComment commentInput" index="{{= index}}" class="commentInput"></td>
	<td><input id="attrLength_{{= index}}" type="text" name="attrLength" index="{{= index}}" 
		class=" lengthInput" maxlength="8" value="255"
		onkeyup="this.value=this.value.replace(/\D/g,'')" 
        onafterpaste="this.value=this.value.replace(/\D/g,'')" ></td>
	<td class="nullTd" index="{{= index}}">
		<input id="attrNull_{{= index}}" type="hidden" value="true">
		<img src="img/checkbox.png"></td>
	<td class="primaryTd" index="{{= index}}">
		<input id="attrPrimary_{{= index}}" type="hidden" value="false">
		<img src="img/primarykey.png" style="display:none;"></td>
</tr>
</script>
<script type="text/javascript">
	var rowIndex = 1;
	var curIndex = 1;
	var layerIndex;
	function clickRow(){
		var index = $(this).attr("index");
		curIndex = index;
		$(".triangle").hide();
		$("#triangle_"+index).show();

		$(".attrRow").css("background-color","#FFF");
		$(".attrInput").css("background-color","#FFF");
		$(".lengthInput").css("background-color","#FFF");
		$(".commentInput").css("background-color","#FFF");
		$(".selectInput").css("background-color","#FFF");
		$(".selectInputRight").css("background-color","#FFF");

		$(this).css("background-color","#EEF6FF");
		
		$("#attrName_"+index).css("background-color","#EEF6FF");
		$("#attrComment_"+index).css("background-color","#EEF6FF");
		$("#attrLength_"+index).css("background-color","#EEF6FF");

		$("#attrType_"+index).css("background-color","#EEF6FF");
		$("#attrTypeDiv_"+index).css("background-color","#EEF6FF");
	};
	var clickNullTd = function(){
		var i = $(this).attr("index");
		var val = $("#attrNull_"+i).val();

		if(val == 'false'){
			$("#attrNull_"+i).val("true");
			$(this).find('img').show();
		}else{
			$("#attrNull_"+i).val("false");
			$(this).find('img').hide();
		}
	};
	var clickPrimaryTd = function(){
		var i = $(this).attr("index");
		var val = $("#attrPrimary_"+i).val();

		if(val == 'false'){
			$("#attrPrimary_"+i).val("true");
			$(this).find('img').show();
		}else{
			$("#attrPrimary_"+i).val("false");
			$(this).find('img').hide();
		}
	};
	/**添加属性行**/
	var addRow = function(){

		rowIndex++;
		$(".triangle").hide();
		var tabs = [ {
			index:rowIndex
		}];
		$("#rowTemplate").tmpl(tabs).appendTo("#attrTable");
		curIndex = rowIndex;

		//重新绑定事件
		$(".attrRow").unbind("click");
		$(".attrRow").bind("click", clickRow); 

		$(".nullTd").unbind("click");
		$(".nullTd").bind("click", clickNullTd);

		$(".primaryTd").unbind("click");
		$(".primaryTd").bind("click", clickPrimaryTd);

		$(".attrInput").unbind("blur");
		$(".attrInput").bind("blur",blurAttrInput);

		$(".selectInput").unbind("change");
		$(".selectInput").bind("change",changeAttrType);

		//清除一下上一个选择的行背景色
		$(".attrRow").css("background-color","#FFF");
		$(".attrInput").css("background-color","#FFF");
		$(".lengthInput").css("background-color","#FFF");
		$(".commentInput").css("background-color","#FFF");
		$(".selectInput").css("background-color","#FFF");
		$(".selectInputRight").css("background-color","#FFF");
	};
	/**删除属性行**/
	var delRow = function(){
		
		var i = $("#attrRow_"+curIndex).next().attr("index");
		if(!i){
			i = $("#attrRow_"+curIndex).prev().attr("index");
		}
		//删除当前行
		$("#attrRow_"+curIndex).remove();
		curIndex = i;

		//移动箭头到下一行
		$(".triangle").hide();
		$("#triangle_"+curIndex).show();
	};
	/**设置主键**/
	var primaryRow = function(){
		var i = $("#attrRow_"+curIndex).attr("index");
		var val = $("#attrPrimary_"+i).val();

		if(val == 'false'){
			$("#attrPrimary_"+i).val("true");
			$("#attrPrimary_"+i).next().show();
		}else{
			$("#attrPrimary_"+i).val("false");
			$("#attrPrimary_"+i).next().hide();
		}
	};
	/**上下移动行**/
	var upRow = function(){
		if($("#attrRow_"+curIndex).prev().attr("index")){
			$("#attrRow_"+curIndex).prev().before($("#attrRow_"+curIndex));
		}
	};
	var downRow = function(){
		if($("#attrRow_"+curIndex).next().attr("index")){
			$("#attrRow_"+curIndex).next().after($("#attrRow_"+curIndex));
		}
	};
	/**生成代码**/
	var generateCode = function(){

		var isprimary = 0;
		var iserror = 0;
		var urlstr = '';
	    $("#attrTable tr").each(function(){   
            var i = $(this).attr("index");
            if(i){
            	var attrName = $.trim($("#attrName_"+i).val());
            	if(attrName == ''){
            		iserror = 1;
            	}
            	urlstr += '&attrName=' + attrName;
				urlstr += '&attrComment=' + $("#attrComment_"+i).val();
				urlstr += '&attrLength=' + $("#attrLength_"+i).val();
				urlstr += '&attrType=' + $("#attrType_"+i).val();
				urlstr += '&attrNull=' + $("#attrNull_"+i).val();

				var attrPrimary = $("#attrPrimary_"+i).val();
				if(attrPrimary == "true"){
					isprimary = 1;
				}
				urlstr += '&attrPrimary=' + isprimary;
            }
        });
        if (iserror == 1) {
        	alert("属性名不能为空！");
        	return false;
        }
        if(isprimary == 0){
        	alert("请设置主键！");
        	return false;
        }
        
        layerIndex = layer.msg('加载中', {icon: 16});//又换了种风格，并且设定最长等待10秒 
        var packageText = $(".packpageNameInput").val();
        var className = $(".classNameInput").val();
    	var url = "/code/code_generate.action?packageName="+packageText+"&className="+className+urlstr;
    	
    	console.log(url);
    	$("#contentFrame").attr("src",url);
        
	};
	var changeAttrType = function(){
		var i = $(this).attr("index");
		var val = $(this).val();
		if(val == 'String'){
			$("#attrLength_"+i).val(255);
		}else if(val == 'Integer'){
			$("#attrLength_"+i).val(11);
		}else if(val == 'Long'){
			$("#attrLength_"+i).val(11);
		}else if(val == 'Byte'){
			$("#attrLength_"+i).val(4);
		}else if(val == 'Float'){
			$("#attrLength_"+i).val(0);
		}else if(val == 'Date'){
			$("#attrLength_"+i).val(0);
		}
	};
	/**翻译后加注释**/
	var blurAttrInput = function(){
		var v1 = $(this).val();

		if(v1 != ''){

			/* $.ajax({
		        url:'http://fanyi.youdao.com/openapi.do',
		        type:'GET',
		        data:{keyfrom:'autojcode',key:'1670955272',type:'data',doctype:'json',version:'1.1',q:v1},
		        dataType:'jsonp',
		        jsonp:'callback',
		        success:function(data){
		           
		        }
		    });*/

		}
	};
	/**绑定事件**/
	var bindEvent = function() {

		$("#add_btn").click(addRow);

		$("#delete_btn").click(delRow);

		$("#primary_btn").click(primaryRow);

		$("#up_btn").click(upRow);
		$("#down_btn").click(downRow);

		$("#generate_btn").click(generateCode);

		$(".attrRow").bind("click", clickRow);

		$(".nullTd").bind("click", clickNullTd);

		$(".primaryTd").bind("click", clickPrimaryTd);

		$(".attrInput").bind("blur",blurAttrInput);

		$(".selectInput").bind("change",changeAttrType);

		//li 内容切换
		$(".menu li").click(function(){
			var cls = $(this).attr("class");
			var cardid = $(this).attr("cardid");

			if(!cls){
				$(".nav-current").removeClass("nav-current");
				$(this).addClass("nav-current");

				$(".menu-card").hide();
				$("#card"+cardid).show();
			}
		});

		//改变滚动条的样式
        //$(".sql-textarea").niceScroll();
        var options = {
		    horizontal: 1,
		    itemNav: 'basic',
		    speed: 300,
		    mouseDragging: 1,
		    touchDragging: 1
		};
		//$('.class-content').sly(options);

        $(".sql-textarea").focus(function(){
        	var val = $(this).val();
        	if(val=='粘贴建表语句即可生成项目代码'){
        		$(this).val("");
        		$(this).css("color","#222222");
        	}
        });
        $(".sql-textarea").blur(function(){
        	var val = $(this).val();
        	if(val==''){
        		$(this).val("粘贴建表语句即可生成项目代码");
        		$(this).css("color","#BCBCBC");
        	}else{
        		
        	}
        });
        
        layerIndex = layer.msg('加载中', {icon: 16});//又换了种风格，并且设定最长等待10秒 
    	$("#contentFrame").load(function(){ 
    		//关闭
    		layer.close(layerIndex); 
    	});
	};
	
	var changeCodeFrame = function(h){
		$("#contentFrame").css("height",h);
	};

	$(function() {

		bindEvent();
	});
</script>

</body>
</html>